# ResNet-Packed-Malware-Detection ![](https://img.shields.io/badge/license-MIT-blue)
Use image recognition methods to analyze packed malware.（使用图像识别方法对加壳恶意软件进行分类）

Based on ResNet, SIFT and ORB.（使用了ResNet，SIFT与ORB）

本项目当前在当前已经实现加固判断二分类且结果具有较高可靠性的基础上已经提供了便利地创建加固类型判断多分类的条件，确定程序加固的关键目标点，着眼于常见免杀机制规避检测手段的重点/隐匿作用点，通过摆脱一般的检测恶意代码作用区段，检测“非恶意”代码段/混淆段来对数种加固规避机制进行测试，在一定程度上降低研究人员在面对加固样本的分析难度，提供一个能快速定位软件加固的目标位置并具有较高可靠度的检测方法。

（截至项目文件上传前，未做完全的集成化，集成化之后上传更新）

（权重文件过大，暂时不上传，后续补充）
****
使用的加壳工具：`VMProtect`/ `The Mida v3`

其他工具：`Ghidra`/ `IDA Pro`/ `Winhex`

硬件环境：

`Intel i7-9750H @2.60GHz 6 Core`

`Nvidia Geforce 1660Ti 6G
（Tensor computeCapability：7.5）`

`Memory: 16.0GB 2666MHz`

`Windows 10 Dev preview 
（Build 23159.co_release.210409-1536）`

软件环境：

`PyCharm 2021.1 ( Community Edition)`

`Python 3.9.1 ( For sample analysis 样本预处理)`

`Python 3.8.8 ( For Tensorflow 模型搭建与测试)`

`Tensorflow 2.4.1 (GPU)`

`CUDA 11.3.0_456.89`

`cudnn 11.2v8.1.1.33`
****

## 文件目录：
> images (结果截取图片，保留了数个验证结果与训练Accuracy与Loss）
>> No_pretrain_acc.png (无预训练的50轮Accuracy)
>> 
>> No_ppretrain_loss.png (无预训练的50轮Loss)
>> 
>> Packed-sample.jpg (加固样本识别结果)
>> 
>> Unpacked-sample.jpg (未加固样本识别结果)

> ResNet (模型与训练、验证)
>> class_indices.json ()
>> model.py (模型架构)
>> 
>> predict.py (训练完毕后的识别)
>> 
>> RGB_MEAN.py (RGB均值计算，详情请查看model.py/ train.py文件)
>> 
>> train.py (训练)

预处理步骤为（未作集成化处理）：

**Convert_file2image.py -> gray2rgb.py -> cutimage_bat.py -> delete_same_image.py**
> Sample Preparation (样本预处理)
> 
>> Convert_file2image.py (文件转为灰度图)
>> 
>> cutimage_bat.py (批量裁剪图像切片)
>> 
>> delete_same_image.py (去除重复切片)
>> 
>> gray2rgb.py (灰度图转为三通道图片)
>> 
>> ORB.py (ORB特征选取)
>> 
>> SIFT.py (SIFT特征选取)

